#!/bin/bash

# This script patches JS file generated by Emscripten
# to provide address bar query parameters as argv to main().

fileName=$1

if [ -z "$fileName" ]; then
    echo "Usage: $0 FILE_NAME"
    exit 1
fi

# Replace
#   `Module["arguments"]=[]`
# with
#   `Module["arguments"]=[window.location.search]`
sed 's|Module\["arguments"\]=\[\]|Module\["arguments"\]=\[window.location.search.substr(1)\]|' $fileName
